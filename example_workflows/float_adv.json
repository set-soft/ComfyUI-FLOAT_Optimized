{"id":"e7b8536c-016b-4592-a26b-43d3183771aa","revision":0,"last_node_id":40,"last_link_id":74,"nodes":[{"id":13,"type":"FloatGetIdentityReference","pos":[792.5450439453125,284.5438232421875],"size":[277.5440979003906,57.76133346557617],"flags":{"collapsed":false},"order":12,"mode":0,"inputs":[{"localized_name":"r_s_lambda_latent","name":"r_s_lambda_latent","type":"TORCH_TENSOR","link":59},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","link":58}],"outputs":[{"localized_name":"r_s_latent (Wr→s)","name":"r_s_latent (Wr→s)","type":"TORCH_TENSOR","links":[24]},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":null}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"296aaf5812a3517b1950133df94529b3abeaa79d","Node name for S&R":"FloatGetIdentityReference","widget_ue_connectable":{}},"widgets_values":[],"color":"#2a363b","bgcolor":"#3f5159"},{"id":17,"type":"LoadAudio","pos":[64.97331237792969,453.5533447265625],"size":[274.080078125,136],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"audio","name":"audio","type":"COMBO","widget":{"name":"audio"},"link":null},{"localized_name":"audioUI","name":"audioUI","type":"AUDIO_UI","widget":{"name":"audioUI"},"link":null},{"localized_name":"choose file to upload","name":"upload","type":"AUDIOUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"AUDIO","name":"AUDIO","type":"AUDIO","links":[42,66]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"LoadAudio","widget_ue_connectable":{}},"widgets_values":["aud-sample-vs-1.wav",null,null],"color":"#233","bgcolor":"#355"},{"id":23,"type":"FloatSampleMotionSequenceRD","pos":[1180,360],"size":[324.5289001464844,210],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"r_s_latent","name":"r_s_latent","type":"TORCH_TENSOR","link":24},{"localized_name":"wa_latent","name":"wa_latent","type":"TORCH_TENSOR","link":67},{"localized_name":"audio_num_frames","name":"audio_num_frames","type":"INT","link":68},{"localized_name":"we_latent","name":"we_latent","type":"TORCH_TENSOR","link":72},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","link":73},{"localized_name":"a_cfg_scale","name":"a_cfg_scale","type":"FLOAT","widget":{"name":"a_cfg_scale"},"link":null},{"localized_name":"e_cfg_scale","name":"e_cfg_scale","type":"FLOAT","widget":{"name":"e_cfg_scale"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null}],"outputs":[{"localized_name":"r_d_latents","name":"r_d_latents","type":"TORCH_TENSOR","links":[60]},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":[61]}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"296aaf5812a3517b1950133df94529b3abeaa79d","Node name for S&R":"FloatSampleMotionSequenceRD","widget_ue_connectable":{"a_cfg_scale":true,"e_cfg_scale":true,"seed":true}},"widgets_values":[2,1,1,"fixed"],"color":"#2a363b","bgcolor":"#3f5159"},{"id":30,"type":"VHS_VideoCombine","pos":[1960,180],"size":[270,598],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":62},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":42},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null},{"localized_name":"frame_rate","name":"frame_rate","type":"FLOAT","widget":{"name":"frame_rate"},"link":63},{"localized_name":"loop_count","name":"loop_count","type":"INT","widget":{"name":"loop_count"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"format","name":"format","type":"COMBO","widget":{"name":"format"},"link":null},{"localized_name":"pingpong","name":"pingpong","type":"BOOLEAN","widget":{"name":"pingpong"},"link":null},{"localized_name":"save_output","name":"save_output","type":"BOOLEAN","widget":{"name":"save_output"},"link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"4c7858ddd5126f7293dc3c9f6e0fc4c263cde079","Node name for S&R":"VHS_VideoCombine","widget_ue_connectable":{"frame_rate":true}},"widgets_values":{"frame_rate":25,"loop_count":0,"filename_prefix":"AnimateDiff","format":"video/nvenc_h264-mp4","pix_fmt":"yuv420p","bitrate":10,"megabit":true,"save_metadata":true,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"AnimateDiff_00018-audio.mp4","subfolder":"","type":"output","format":"video/nvenc_h264-mp4","frame_rate":25,"workflow":"AnimateDiff_00018.png","fullpath":"/home/salvador/0Data/IA/ComfyUI/output/AnimateDiff_00018-audio.mp4"}}},"color":"#222","bgcolor":"#000"},{"id":4,"type":"LoadFloatModelsOpt","pos":[60,270],"size":[283.810546875,106],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"advanced_float_options","name":"advanced_float_options","shape":7,"type":"ADV_FLOAT_DICT","link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"target_device","name":"target_device","type":"COMBO","widget":{"name":"target_device"},"link":null},{"localized_name":"cudnn_benchmark","name":"cudnn_benchmark","type":"BOOLEAN","widget":{"name":"cudnn_benchmark"},"link":null}],"outputs":[{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":[57,65]}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"2c3fd3c75c6f34b6524a56b68a1cf4fe6a47049e","Node name for S&R":"LoadFloatModelsOpt","widget_ue_connectable":{}},"widgets_values":["FLOAT.safetensors","cuda",false],"color":"#2a363b","bgcolor":"#3f5159"},{"id":35,"type":"PreviewImage","pos":[450,-230],"size":[140,246],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":53}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.40","Node name for S&R":"PreviewImage","widget_ue_connectable":{}},"widgets_values":[],"color":"#233","bgcolor":"#355"},{"id":33,"type":"FloatImageFaceAlign","pos":[100,-20],"size":[270,130],"flags":{},"order":8,"mode":4,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":54},{"localized_name":"face_margin","name":"face_margin","type":"FLOAT","widget":{"name":"face_margin"},"link":null},{"localized_name":"rgba_conversion","name":"rgba_conversion","type":"COMBO","widget":{"name":"rgba_conversion"},"link":null},{"localized_name":"bkg_color_hex","name":"bkg_color_hex","type":"STRING","widget":{"name":"bkg_color_hex"},"link":null},{"localized_name":"size","name":"size","shape":7,"type":"INT","widget":{"name":"size"},"link":null}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[53,56]}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"cd98751e337e7ad09488b7a1af6f8d298ccdd12f","Node name for S&R":"FloatImageFaceAlign","widget_ue_connectable":{}},"widgets_values":[1.6,"blend_with_color","#000000",512],"color":"#2a363b","bgcolor":"#3f5159"},{"id":34,"type":"MarkdownNote","pos":[90,-190],"size":[280,110],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"title":"Face Align for FLOAT  (Ad)","properties":{"widget_ue_connectable":{}},"widgets_values":["The node below ensures the size of the image is correct.\n\nIt can detect faces and crop the image to put the face in correct place.\n\nEnable it if needed"],"color":"#432","bgcolor":"#653"},{"id":1,"type":"LoadImage","pos":[-260,-100],"size":[274.080078125,314.0000305175781],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"choose file to upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[54]},{"localized_name":"MASK","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.34","Node name for S&R":"LoadImage","widget_ue_connectable":{}},"widgets_values":["sam_altman_512x512.jpg","image"],"color":"#233","bgcolor":"#355"},{"id":38,"type":"FloatDecodeLatentsToImages","pos":[1590,160],"size":[285.5289001464844,80],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"appearance_pipe","name":"appearance_pipe","type":"FLOAT_APPEARANCE_PIPE","link":64},{"localized_name":"r_d_latents","name":"r_d_latents","type":"TORCH_TENSOR","link":60},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","link":61}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","links":[62]},{"localized_name":"fps","name":"fps","type":"FLOAT","links":[63]},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":null}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"794b6933e1b46718be2e8d0b03f3c67da160ea1f","Node name for S&R":"FloatDecodeLatentsToImages","widget_ue_connectable":{}},"widgets_values":[],"color":"#2a363b","bgcolor":"#3f5159"},{"id":37,"type":"FloatEncodeImageToLatents","pos":[450,160],"size":[277.7564392089844,86],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"ref_image","name":"ref_image","type":"IMAGE","link":56},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","link":57}],"outputs":[{"localized_name":"appearance_pipe (Ws→r)","name":"appearance_pipe (Ws→r)","type":"FLOAT_APPEARANCE_PIPE","links":[64]},{"localized_name":"r_s_lambda_latent","name":"r_s_lambda_latent","type":"TORCH_TENSOR","links":[59]},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":[58]}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"794b6933e1b46718be2e8d0b03f3c67da160ea1f","Node name for S&R":"FloatEncodeImageToLatents","widget_ue_connectable":{}},"widgets_values":[],"color":"#2a363b","bgcolor":"#3f5159"},{"id":39,"type":"FloatEncodeAudioToLatentWA","pos":[430,380],"size":[310.5357360839844,118],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","link":65},{"localized_name":"audio","name":"audio","type":"AUDIO","link":66},{"localized_name":"fps","name":"fps","type":"FLOAT","widget":{"name":"fps"},"link":null}],"outputs":[{"localized_name":"wa_latent","name":"wa_latent","type":"TORCH_TENSOR","links":[67]},{"localized_name":"audio_num_frames","name":"audio_num_frames","type":"INT","links":[68]},{"localized_name":"processed_audio_features","name":"processed_audio_features","type":"TORCH_TENSOR","links":[74]},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":[71]}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"e5945270df082102f672c20bf4a46cee936cc571","Node name for S&R":"FloatEncodeAudioToLatentWA","widget_ue_connectable":{}},"widgets_values":[25],"color":"#2a363b","bgcolor":"#3f5159"},{"id":40,"type":"FloatEncodeEmotionToLatentWE","pos":[800,480],"size":[320,78],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"processed_audio_features","name":"processed_audio_features","type":"TORCH_TENSOR","link":74},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","link":71},{"localized_name":"emotion","name":"emotion","type":"COMBO","widget":{"name":"emotion"},"link":null}],"outputs":[{"localized_name":"we_latent","name":"we_latent","type":"TORCH_TENSOR","links":[72]},{"localized_name":"float_pipe","name":"float_pipe","type":"FLOAT_PIPE","links":[73]}],"properties":{"aux_id":"set-soft/ComfyUI-FLOAT","ver":"e5945270df082102f672c20bf4a46cee936cc571","Node name for S&R":"FloatEncodeEmotionToLatentWE","widget_ue_connectable":{}},"widgets_values":["none"],"color":"#2a363b","bgcolor":"#3f5159"},{"id":32,"type":"MarkdownNote","pos":[-570,-100],"size":[290,120],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"title":"Load Image","properties":{"widget_ue_connectable":{}},"widgets_values":["# Put an image here\nThe best results are for 512x512 images\n\nWith a human face centered and 60% of margin"],"color":"#432","bgcolor":"#653"},{"id":36,"type":"MarkdownNote","pos":[-240,460],"size":[280,120],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[],"title":"Input audio to drive the image","properties":{"widget_ue_connectable":{}},"widgets_values":["# Put the audio here\nUse clear voice audio, avoid music that can be confused with the voice"],"color":"#432","bgcolor":"#653"},{"id":31,"type":"MarkdownNote","pos":[-240,280],"size":[270,90],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"title":"Load FLOAT Models (Opt)","properties":{"widget_ue_connectable":{}},"widgets_values":["Download the [FLOAT model](https://huggingface.co/set-soft/float/resolve/main/FLOAT.safetensors?download=true)"],"color":"#432","bgcolor":"#653"}],"links":[[24,13,0,23,0,"TORCH_TENSOR"],[42,17,0,30,1,"AUDIO"],[53,33,0,35,0,"IMAGE"],[54,1,0,33,0,"IMAGE"],[56,33,0,37,0,"IMAGE"],[57,4,0,37,1,"FLOAT_PIPE"],[58,37,2,13,1,"FLOAT_PIPE"],[59,37,1,13,0,"TORCH_TENSOR"],[60,23,0,38,1,"TORCH_TENSOR"],[61,23,1,38,2,"FLOAT_PIPE"],[62,38,0,30,0,"IMAGE"],[63,38,1,30,4,"FLOAT"],[64,37,0,38,0,"FLOAT_APPEARANCE_PIPE"],[65,4,0,39,0,"FLOAT_PIPE"],[66,17,0,39,1,"AUDIO"],[67,39,0,23,1,"TORCH_TENSOR"],[68,39,1,23,2,"INT"],[71,39,3,40,1,"FLOAT_PIPE"],[72,40,0,23,3,"TORCH_TENSOR"],[73,40,1,23,4,"FLOAT_PIPE"],[74,39,2,40,0,"TORCH_TENSOR"]],"groups":[],"config":{},"extra":{"ds":{"scale":0.9275386206062108,"offset":[371.9314082891759,251.52712087665637]},"reroutes":[{"id":18,"pos":[480.5937805175781,618.9921875],"linkIds":[42]},{"id":19,"parentId":18,"pos":[1619.7177734375,612.7716674804688],"linkIds":[42]}],"ue_links":[],"links_added_by_ue":[],"linkExtensions":[{"id":42,"parentId":19}]},"version":0.4}
